<!doctype html> 
<html>

<head>

<title>performance.timing: print events array</title>

<style>
rect { 
border-left: 1px solid red;
}
</style>

<script type="text/javascript" src="https://www.google.com/jsapi"></script>

<script type="text/javascript">
google.load("visualization", "1", {packages:["corechart"]});
google.setOnLoadCallback(drawChart);
function drawChart() {
	
	var events = []; // navigation or load events
	var notApplicable = []; // navigation or load events with zero time
	// for each attribute in performance.timing
	// create an object and add it to the events array
	var minTime = Number.MAX_VALUE;
	var maxTime = Number.MIN_VALUE;
	Object.keys(performance.timing).forEach(function(key){	
		var time = parseInt(performance.timing[key]);
		if (time === 0) {
			notApplicable.push(key);
		} else {
			var event = {};
			event["attribute"] = key;
			if (time > maxTime) {
				maxTime = time;
			}
			if (time < minTime) {
				minTime = time;
			}
			event["time"] = time;
			events.push(event);
		}
	})	
	
	// 'normalise' times, subtracting minTime from each event time
	// so that event times begin with zero
	events.forEach(function(event){
		event.time -= minTime ;
	});

	// sort the events array by time
	events.sort(function(a, b){return a.time - b.time});

	
	var data = new google.visualization.DataTable();
	data.addColumn('string', 'Attribute');
	data.addColumn('number', 'Time after first event (ms)');
	data.addRows(events.length);
	for (var i = 0; i != events.length; ++i) {
		data.setValue(i, 0, events[i].attribute);
		data.setValue(i, 1, events[i].time); 
	}
	
	var chart = new google.visualization.BarChart(document.getElementById('chart_div'));
	chart.draw(data, {
		chartArea: {left: 210}, // corresponds to horizontal space for labels at left
//		colors: ['#cccccc'],
		hAxis: {baselineColor: "#fff"},
		height: events.length * 30, 
		width: 850
	});		
}

// from https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/keys
if (!Object.keys) Object.keys = function(o){
 if (o !== Object(o))
      throw new TypeError('Object.keys called on non-object');
 var ret=[], p;
 for (p in o) if (Object.prototype.hasOwnProperty.call(o, p)) ret.push(p);
 return ret;
}
</script>

<script type="text/javascript">
</script>


</head>

<body>

<div>
	<a href="http://en.wikipedia.org/wiki/File:Uluru_(Helicopter_view)-crop.jpg" title="Uluru, helicopter view image from Wikipedia"><img src="http://upload.wikimedia.org/wikipedia/commons/thumb/f/fc/Uluru_%28Helicopter_view%29-crop.jpg/800px-Uluru_%28Helicopter_view%29-crop.jpg" title="Uluru, helicopter view image from Wikipedia"></a>
</div>

<div id="chart_div"></div>

</body>

</html>