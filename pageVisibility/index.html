<!DOCTYPE html>
<html>

<head>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 

<title>Page Visibility demo</title>

</head>

<body>

<video id="videoElement" src="video/dizzy.mp4" autoplay controls />

<script src="js/jquery-1.6.1.js"></script>
<script src="js/favicon.js"></script>

<script type="text/javascript">

var videoElement = document.getElementById("videoElement");

// if the page is hidden, pause the video and change the icon
// if the page is shown, start playing and change the icon
function handleVisibilityChange() {
	if (document.webkitHidden) {
		videoElement.pause();
	} else {
		videoElement.play();
	}
}

document.addEventListener("webkitvisibilitychange", 
	handleVisibilityChange, false);

videoElement.addEventListener("pause", function(){
		favicon.change('images/paused.png');
	}, false);

videoElement.addEventListener("play", function(){
		favicon.change('images/playing.png');
	}, false);

videoElement.addEventListener("timeupdate", function(){
		document.title = "Page Visibility: " + 
			Math.floor(videoElement.currentTime);
	}, false);

// if document doesn't support webkitHidden
// if (!document.webkitHidden) {
// 	alert("This browser does not support the Page Visibility API");
// 	videoElement.play(); 
// }
</script>

</body>

</html>